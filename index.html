<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HNU CSIT CGPA CALC</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* Custom CSS for GPA Calculator */

        /* Add some modern styling */
        * {
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2d3436;
            --secondary-color: #636e72;
            --success-color: #00b894;
            --danger-color: #e17055;
            --warning-color: #fdcb6e;
            --info-color: #74b9ff;
            --light-color: #f8f9fa;
            --dark-color: #2d3436;
            --accent-color: #6c5ce7;
        }

        /* Dark theme variables */
        [data-bs-theme="dark"] {
            --bs-body-bg: #1a1a1a;
            --bs-body-color: #ffffff;
            --bs-card-bg: #2d2d2d;
            --bs-border-color: #404040;
        }

        body {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            min-height: 100vh;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            color: #2d3436;
            line-height: 1.6;
        }

        /* Header styling */
        .display-6 {
            font-weight: 600;
            letter-spacing: -0.02em;
            color: #2d3436;
            margin-bottom: 1rem;
        }

        /* Dark mode body */
        [data-bs-theme="dark"] body {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        }

        /* Card styling */
        .card {
            border: 1px solid #e9ecef;
            border-radius: 16px;
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
            color: #2d3436;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        [data-bs-theme="dark"] .card {
            background: rgba(45, 45, 45, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 35px rgba(0, 0, 0, 0.12);
        }

        /* Table styling */
        .table {
            margin-bottom: 0;
        }

        .table thead th {
            border-bottom: 2px solid var(--primary-color);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
        }

        .table tbody tr {
            transition: all 0.2s ease;
        }

        .table tbody tr:hover {
            background-color: rgba(108, 92, 231, 0.05);
            transform: scale(1.01);
        }

        /* Form controls */
        .form-control, .form-select {
            border-radius: 10px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 0.25rem rgba(108, 92, 231, 0.15);
            transform: translateY(-1px);
        }

        /* Button styling */
        .btn {
            border-radius: 12px;
            font-weight: 500;
            font-size: 0.9rem;
            padding: 0.6rem 1.2rem;
            transition: all 0.3s ease;
            border: none;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .btn-success {
            background: linear-gradient(45deg, #00b894, #00cec9);
            border: none;
            color: white;
        }

        .btn-danger {
            background: linear-gradient(45deg, #dc3545, #e74c3c);
            border: none;
        }

        .btn-outline-secondary {
            border: 2px solid var(--secondary-color);
        }

        .btn-outline-primary {
            border: 2px solid #6c5ce7;
            color: #6c5ce7;
            background: transparent;
        }

        .btn-outline-primary:hover {
            background: #6c5ce7;
            border-color: #6c5ce7;
            color: white;
        }

        .btn-outline-primary.active {
            background: #6c5ce7;
            border-color: #6c5ce7;
            color: white;
            box-shadow: 0 4px 12px rgba(108, 92, 231, 0.3);
        }

        /* Button group styling */
        .btn-group .btn {
            border-radius: 12px;
            margin: 0 2px;
        }

        .btn-group .btn:first-child {
            border-radius: 12px 12px 12px 12px;
        }

        .btn-group .btn:last-child {
            border-radius: 12px 12px 12px 12px;
        }

        /* Modern spacing */
        .container-fluid {
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Add subtle animations */
        .card, .btn, .form-control, .form-select {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Improve table styling */
        .table th {
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #636e72;
            border-bottom: 2px solid #e9ecef;
        }

        /* Add modern shadows */
        .shadow-sm {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
        }

        /* Responsive improvements */
        @media (max-width: 768px) {
            .container-fluid {
                padding: 1rem;
            }
            
            .display-6 {
                font-size: 1.8rem;
            }
            
            .btn-group .btn {
                padding: 0.5rem 0.8rem;
                font-size: 0.8rem;
            }
        }

        /* Icon styling */
        .course-icon {
            width: 20px;
            height: 20px;
            margin-right: 8px;
        }

        /* Grade badge styling */
        .grade-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.85rem;
            text-align: center;
            min-width: 50px;
        }

        .grade-a-plus, .grade-a {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
        }

        .grade-a-minus, .grade-b-plus {
            background: linear-gradient(45deg, #17a2b8, #6610f2);
            color: white;
        }

        .grade-b, .grade-b-minus {
            background: linear-gradient(45deg, #ffc107, #fd7e14);
            color: #212529;
        }

        .grade-c-plus, .grade-c {
            background: linear-gradient(45deg, #6c757d, #495057);
            color: white;
        }

        .grade-c-minus, .grade-d-plus, .grade-d, .grade-d-minus {
            background: linear-gradient(45deg, #dc3545, #c82333);
            color: white;
        }

        .grade-f {
            background: linear-gradient(45deg, #343a40, #23272b);
            color: white;
        }

        /* GPA Display styling */
        .gpa-display {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            text-align: center;
            margin: 20px 0;
        }

        .gpa-label {
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--secondary-color);
            text-align: center;
            margin-bottom: 10px;
        }

        /* Dark mode adjustments */
        [data-bs-theme="dark"] .gpa-display {
            color: #ffffff;
        }

        [data-bs-theme="dark"] .gpa-label {
            color: #adb5bd;
        }

        /* Animation for GPA updates */
        .gpa-display {
            transition: all 0.3s ease;
        }

        .gpa-display.updated {
            transform: scale(1.05);
        }

        /* Footer styling */
        .footer {
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            color: var(--secondary-color);
            font-size: 0.9rem;
        }

        /* Notification styling */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1050;
            max-width: 300px;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10 col-xl-8">
                <!-- Header -->
                <div class="text-center mb-4 pt-4">
                    <h1 class="display-6 fw-bold">
                        HNU CSIT CGPA CALC
                        <i class="fas fa-calculator text-danger ms-2"></i>
                    </h1>
                </div>

                <!-- Controls Section -->
                <div class="card mb-4 shadow-sm">
                    <div class="card-body">
                        <div class="row g-3">
                            <!-- Academic Year Selection -->
                            <div class="col-md-6">
                                <label for="academicYear" class="form-label fw-semibold">Select Academic Year:</label>
                                <select class="form-select" id="academicYear">
                                    <option value="first">First Year</option>
                                    <option value="second">Second Year</option>
                                    <option value="third">Third Year</option>
                                    <option value="fourth">Fourth Year</option>
                                    <option value="fifth">Fifth Year</option>
                                </select>
                            </div>
                            
                            <!-- Semester Selection -->
                            <div class="col-md-6">
                                <label for="semester" class="form-label fw-semibold">Select Semester:</label>
                                <div class="btn-group w-100" role="group">
                                    <button type="button" class="btn btn-outline-primary" id="springBtn">Spring 2025</button>
                                    <button type="button" class="btn btn-outline-primary" id="fallBtn">Fall 2025</button>
                                    <button type="button" class="btn btn-outline-primary active" id="allBtn">All Semesters</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Main Content -->
                <div class="row">
                    <!-- Courses Table -->
                    <div class="col-lg-8">
                        <div class="card shadow-sm">
                            <div class="card-header">
                                <h5 class="card-title mb-0">
                                    <i class="fas fa-list-alt me-2"></i>Course List
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Course</th>
                                                <th>Credits</th>
                                                <th>Marks</th>
                                                <th>Grade</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="coursesTableBody">
                                            <!-- Dynamic content will be inserted here -->
                                        </tbody>
                                    </table>
                                </div>
                                <div class="mt-3">
                                    <button class="btn btn-success me-2" onclick="gpaCalculator.addCourse()">
                                        <i class="fas fa-plus me-1"></i>Add Course
                                    </button>
                                    <button class="btn btn-outline-secondary me-2" onclick="gpaCalculator.resetAllData()">
                                        <i class="fas fa-trash me-1"></i>Reset All
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- GPA Display & Info -->
                    <div class="col-lg-4">
                        <!-- GPA Display -->
                        <div class="card shadow-sm mb-4">
                            <div class="card-header text-center">
                                <h5 class="card-title mb-0">
                                    <i class="fas fa-chart-line me-2"></i>GPA Summary
                                </h5>
                            </div>
                            <div class="card-body text-center">
                                <div class="gpa-label">Current GPA</div>
                                <div class="gpa-display" id="gpaDisplay">0.00</div>
                                <div class="row text-center">
                                    <div class="col-6">
                                        <small class="text-muted">Total Credits</small>
                                        <div class="fw-bold" id="totalCredits">0</div>
                                    </div>
                                    <div class="col-6">
                                        <small class="text-muted">Total Courses</small>
                                        <div class="fw-bold" id="totalCourses">0</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Grading Scale -->
                        <div class="card shadow-sm">
                            <div class="card-header">
                                <h6 class="card-title mb-0">
                                    <i class="fas fa-graduation-cap me-2"></i>Grading Scale
                                </h6>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <thead>
                                            <tr>
                                                <th>Grade</th>
                                                <th>Points</th>
                                                <th>Marks Range</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr><td><span class="grade-badge grade-a-plus">A+</span></td><td><strong>4.0</strong></td><td>96-100</td></tr>
                                            <tr><td><span class="grade-badge grade-a">A</span></td><td><strong>3.7</strong></td><td>92-95</td></tr>
                                            <tr><td><span class="grade-badge grade-a-minus">A-</span></td><td><strong>3.4</strong></td><td>88-91</td></tr>
                                            <tr><td><span class="grade-badge grade-b-plus">B+</span></td><td><strong>3.2</strong></td><td>84-87</td></tr>
                                            <tr><td><span class="grade-badge grade-b">B</span></td><td><strong>3.0</strong></td><td>80-83</td></tr>
                                            <tr><td><span class="grade-badge grade-b-minus">B-</span></td><td><strong>2.8</strong></td><td>76-79</td></tr>
                                            <tr><td><span class="grade-badge grade-c-plus">C+</span></td><td><strong>2.6</strong></td><td>72-75</td></tr>
                                            <tr><td><span class="grade-badge grade-c">C</span></td><td><strong>2.4</strong></td><td>68-71</td></tr>
                                            <tr><td><span class="grade-badge grade-c-minus">C-</span></td><td><strong>2.2</strong></td><td>64-67</td></tr>
                                            <tr><td><span class="grade-badge grade-d-plus">D+</span></td><td><strong>2.0</strong></td><td>60-63</td></tr>
                                            <tr><td><span class="grade-badge grade-d">D</span></td><td><strong>1.5</strong></td><td>55-59</td></tr>
                                            <tr><td><span class="grade-badge grade-d-minus">D-</span></td><td><strong>1.0</strong></td><td>50-54</td></tr>
                                            <tr><td><span class="grade-badge grade-f">F</span></td><td><strong>0.0</strong></td><td>0-49</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Footer -->
                <div class="footer">
                    <p>Made with ❤️ by @sampledoom</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        class GPACalculator {
            constructor() {
                this.courses = [];
                this.courseIdCounter = 0;
                this.currentAcademicYear = 'first';
                this.currentSemester = 'all';
                this.isDarkMode = false;
                
                // Grade scale mapping based on your university's exact grading scale
                this.gradeScale = [
                    { grade: 'A+', points: 4.0, minMarks: 96, maxMarks: 100 },
                    { grade: 'A', points: 3.7, minMarks: 92, maxMarks: 95 },
                    { grade: 'A-', points: 3.4, minMarks: 88, maxMarks: 91 },
                    { grade: 'B+', points: 3.2, minMarks: 84, maxMarks: 87 },
                    { grade: 'B', points: 3.0, minMarks: 80, maxMarks: 83 },
                    { grade: 'B-', points: 2.8, minMarks: 76, maxMarks: 79 },
                    { grade: 'C+', points: 2.6, minMarks: 72, maxMarks: 75 },
                    { grade: 'C', points: 2.4, minMarks: 68, maxMarks: 71 },
                    { grade: 'C-', points: 2.2, minMarks: 64, maxMarks: 67 },
                    { grade: 'D+', points: 2.0, minMarks: 60, maxMarks: 63 },
                    { grade: 'D', points: 1.5, minMarks: 55, maxMarks: 59 },
                    { grade: 'D-', points: 1.0, minMarks: 50, maxMarks: 54 },
                    { grade: 'F', points: 0.0, minMarks: 0, maxMarks: 49 }
                ];
                
                // Course icons for different subjects
                this.courseIcons = {
                    'mathematics': 'fa-calculator',
                    'discrete': 'fa-sitemap',
                    'physics': 'fa-atom',
                    'computers': 'fa-laptop',
                    'programming': 'fa-code',
                    'english': 'fa-book',
                    'management': 'fa-users',
                    'statistics': 'fa-chart-bar',
                    'information': 'fa-database',
                    'social': 'fa-globe',
                    'creative': 'fa-lightbulb',
                    'ethics': 'fa-balance-scale',
                    'logic': 'fa-microchip',
                    'default': 'fa-book-open'
                };
                
                this.initializeApp();
            }
            
            initializeApp() {
                this.setupEventListeners();
                this.loadDefaultCourses();
                this.loadSavedData();
                this.renderCoursesTable();
                this.calculateGPA();
            }
            
            setupEventListeners() {
                // Academic year selection
                document.getElementById('academicYear').addEventListener('change', (e) => {
                    this.currentAcademicYear = e.target.value;
                    this.renderCoursesTable();
                    this.calculateGPA();
                });
                
                // Semester filter buttons
                document.getElementById('springBtn').addEventListener('click', () => this.filterSemester('spring'));
                document.getElementById('fallBtn').addEventListener('click', () => this.filterSemester('fall'));
                document.getElementById('allBtn').addEventListener('click', () => this.filterSemester('all'));
            }
            
            loadDefaultCourses() {
                if (this.courses.length === 0) {
                    const defaultCourses = [
                        // SPRING 2024 (exact transcript data)
                        { name: 'BAS 102 - Discrete Mathematics', credits: 3, marks: 75, icon: 'discrete', semester: 'spring' },
                        { name: 'BAS 103 - Physics', credits: 3, marks: 77, icon: 'physics', semester: 'spring' },
                        { name: 'BAS 203 - Fundamentals of Management', credits: 3, marks: 79, icon: 'management', semester: 'spring' },
                        { name: 'COM 103 - Programming', credits: 3, marks: 62, icon: 'programming', semester: 'spring' },
                        { name: 'GEN 102 - English II', credits: 2, marks: 90, icon: 'english', semester: 'spring' },
                        { name: 'GEN 113 - Creative Thinking', credits: 2, marks: 90, icon: 'creative', semester: 'spring' },
                        // FALL 2024 (exact transcript data)
                        { name: 'BAS 101 - Mathematics', credits: 3, marks: 62, icon: 'mathematics', semester: 'fall' },
                        { name: 'BAS 102 - Discrete Mathematics', credits: 3, marks: 35, icon: 'discrete', semester: 'fall' },
                        { name: 'BAS 104 - Statistics and Probabilities', credits: 3, marks: 64, icon: 'statistics', semester: 'fall' },
                        { name: 'COM 101 - Introduction to Computers', credits: 3, marks: 71, icon: 'computers', semester: 'fall' },
                        { name: 'COM 102 - Fundamentals of IS', credits: 3, marks: 69, icon: 'information', semester: 'fall' },
                        { name: 'GEN 101 - English I', credits: 2, marks: 87, icon: 'english', semester: 'fall' },
                        { name: 'GEN 103 - Social Issues & Anti-Corruption', credits: 2, marks: 70, icon: 'social', semester: 'fall' }
                    ];
                    
                    this.courses = defaultCourses.map((course, index) => ({
                        id: index + 1,
                        ...course
                    }));
                    
                    this.courseIdCounter = this.courses.length;
                }
            }
            
            filterSemester(semester) {
                this.currentSemester = semester;
                
                // Update button active states
                document.querySelectorAll('.btn-outline-primary').forEach(btn => btn.classList.remove('active'));
                
                if (semester === 'spring') {
                    document.getElementById('springBtn').classList.add('active');
                } else if (semester === 'fall') {
                    document.getElementById('fallBtn').classList.add('active');
                } else {
                    document.getElementById('allBtn').classList.add('active');
                }
                
                this.renderCoursesTable();
                this.calculateGPA();
            }
            
            addCourse(courseName = '', credits = 3, marks = '') {
                const newCourse = {
                    id: ++this.courseIdCounter,
                    name: courseName,
                    credits: credits,
                    marks: marks,
                    icon: 'default',
                    semester: this.currentSemester === 'all' ? 'spring' : this.currentSemester
                };
                
                this.courses.push(newCourse);
                this.renderCoursesTable();
                this.calculateGPA();
                this.saveData();
            }
            
            removeCourse(courseId) {
                this.courses = this.courses.filter(course => course.id !== courseId);
                this.renderCoursesTable();
                this.calculateGPA();
                this.saveData();
            }
            
            updateCourse(courseId, field, value) {
                const course = this.courses.find(c => c.id === courseId);
                if (course) {
                    if (field === 'credits') {
                        course[field] = parseInt(value) || 0;
                    } else if (field === 'marks') {
                        course[field] = parseFloat(value) || '';
                        // Update just the grade badge for this specific course
                        this.updateGradeBadge(courseId, course.marks);
                    } else {
                        course[field] = value;
                    }
                    
                    this.calculateGPA();
                    this.saveData();
                }
            }
            
            updateCourseMarks(courseId, value) {
                const course = this.courses.find(c => c.id === courseId);
                if (course) {
                    course.marks = parseFloat(value) || '';
                    // Update just the grade badge without re-rendering the whole table
                    this.updateGradeBadge(courseId, course.marks);
                    this.calculateGPA();
                    this.saveData();
                }
            }
            
            updateGradeBadge(courseId, marks) {
                const grade = this.getGradeFromMarks(marks);
                const gradeClass = this.getGradeBadgeClass(grade);
                
                // Find the grade badge element and update it
                const rows = document.querySelectorAll('#coursesTableBody tr');
                rows.forEach(row => {
                    const deleteBtn = row.querySelector('button[onclick*="' + courseId + '"]');
                    if (deleteBtn) {
                        const gradeBadge = row.querySelector('.grade-badge');
                        if (gradeBadge) {
                            gradeBadge.className = `grade-badge ${gradeClass}`;
                            gradeBadge.textContent = grade;
                        }
                    }
                });
            }
            
            getGradeFromMarks(marks) {
                if (marks === '' || marks === null || marks === undefined) return '';
                
                const numMarks = parseFloat(marks);
                
                // Find the appropriate grade based on marks range
                for (const gradeInfo of this.gradeScale) {
                    if (numMarks >= gradeInfo.minMarks && numMarks <= gradeInfo.maxMarks) {
                        return gradeInfo.grade;
                    }
                }
                return 'F';
            }
            
            getGradeBadgeClass(grade) {
                const gradeClasses = {
                    'A+': 'grade-a-plus',
                    'A': 'grade-a',
                    'A-': 'grade-a-minus',
                    'B+': 'grade-b-plus',
                    'B': 'grade-b',
                    'B-': 'grade-b-minus',
                    'C+': 'grade-c-plus',
                    'C': 'grade-c',
                    'C-': 'grade-c-minus',
                    'D+': 'grade-d-plus',
                    'D': 'grade-d',
                    'D-': 'grade-d-minus',
                    'F': 'grade-f'
                };
                
                return gradeClasses[grade] || 'grade-f';
            }
            
            getCourseIcon(iconType) {
                return this.courseIcons[iconType] || this.courseIcons.default;
            }
            
            renderCoursesTable() {
                const tbody = document.getElementById('coursesTableBody');
                
                // Filter courses based on current semester
                let filteredCourses = this.courses;
                if (this.currentSemester !== 'all') {
                    filteredCourses = this.courses.filter(course => course.semester === this.currentSemester);
                }
                
                tbody.innerHTML = '';
                
                filteredCourses.forEach(course => {
                    const grade = this.getGradeFromMarks(course.marks);
                    const gradeClass = this.getGradeBadgeClass(grade);
                    const iconClass = this.getCourseIcon(course.icon);
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>
                            <i class="fas ${iconClass} course-icon"></i>
                            <input type="text" class="form-control form-control-sm d-inline-block" 
                                   style="width: calc(100% - 40px);" 
                                   value="${course.name}" 
                                   onchange="gpaCalculator.updateCourse(${course.id}, 'name', this.value)">
                        </td>
                        <td>
                            <input type="number" class="form-control form-control-sm" 
                                   value="${course.credits}" min="1" max="6"
                                   onchange="gpaCalculator.updateCourse(${course.id}, 'credits', this.value)">
                        </td>
                        <td>
                            <input type="number" class="form-control form-control-sm" 
                                   value="${course.marks}" min="0" max="100" step="0.1"
                                   onchange="gpaCalculator.updateCourse(${course.id}, 'marks', this.value)"
                                   oninput="gpaCalculator.updateCourseMarks(${course.id}, this.value)">
                        </td>
                        <td>
                            <span class="grade-badge ${gradeClass}">${grade}</span>
                        </td>
                        <td>
                            <button class="btn btn-sm btn-outline-danger" 
                                    onclick="gpaCalculator.removeCourse(${course.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
            
            calculateGPA() {
                let totalPoints = 0;
                let totalCredits = 0;
                let coursesWithGrades = 0;
                
                // Filter courses based on current semester
                let filteredCourses = this.courses;
                if (this.currentSemester !== 'all') {
                    filteredCourses = this.courses.filter(course => course.semester === this.currentSemester);
                }
                
                filteredCourses.forEach(course => {
                    if (course.marks !== '' && course.marks !== null && course.marks !== undefined) {
                        const grade = this.getGradeFromMarks(course.marks);
                        const gradeInfo = this.gradeScale.find(g => g.grade === grade);
                        const points = gradeInfo ? gradeInfo.points : 0;
                        
                        totalPoints += points * course.credits;
                        totalCredits += course.credits;
                        coursesWithGrades++;
                    }
                });
                
                const gpa = totalCredits > 0 ? (totalPoints / totalCredits) : 0;
                
                this.updateDisplay(gpa, totalCredits, coursesWithGrades);
            }
            
            updateDisplay(gpa = 0, totalCredits = 0, totalCourses = 0) {
                const gpaDisplay = document.getElementById('gpaDisplay');
                const totalCreditsDisplay = document.getElementById('totalCredits');
                const totalCoursesDisplay = document.getElementById('totalCourses');
                
                // Add animation class
                gpaDisplay.classList.add('updated');
                setTimeout(() => gpaDisplay.classList.remove('updated'), 300);
                
                gpaDisplay.textContent = gpa.toFixed(2);
                totalCreditsDisplay.textContent = totalCredits;
                totalCoursesDisplay.textContent = totalCourses;
                
                // Change color based on GPA
                if (gpa >= 3.5) {
                    gpaDisplay.style.color = '#28a745';
                } else if (gpa >= 3.0) {
                    gpaDisplay.style.color = '#ffc107';
                } else if (gpa >= 2.0) {
                    gpaDisplay.style.color = '#fd7e14';
                } else {
                    gpaDisplay.style.color = '#dc3545';
                }
            }
            
            resetAllData() {
                if (confirm('Are you sure you want to reset all data? This will remove all courses and cannot be undone.')) {
                    this.courses = [];
                    this.courseIdCounter = 0;
                    this.loadDefaultCourses();
                    this.renderCoursesTable();
                    this.calculateGPA();
                    this.saveData();
                    this.showNotification('All data has been reset!', 'warning');
                }
            }
            
            saveData() {
                try {
                    localStorage.setItem('gpaCalculatorData', JSON.stringify({
                        courses: this.courses,
                        courseIdCounter: this.courseIdCounter,
                        currentAcademicYear: this.currentAcademicYear,
                        currentSemester: this.currentSemester
                    }));
                } catch (error) {
                    console.error('Error saving data:', error);
                }
            }
            
            loadSavedData() {
                try {
                    const savedData = localStorage.getItem('gpaCalculatorData');
                    if (savedData) {
                        const data = JSON.parse(savedData);
                        
                        // Only load if we have saved courses
                        if (data.courses && data.courses.length > 0) {
                            this.courses = data.courses;
                            this.courseIdCounter = data.courseIdCounter || this.courses.length;
                            this.currentAcademicYear = data.currentAcademicYear || 'first';
                            this.currentSemester = data.currentSemester || 'all';
                            
                            // Update UI to reflect loaded state
                            document.getElementById('academicYear').value = this.currentAcademicYear;
                            this.filterSemester(this.currentSemester);
                        }
                    }
                } catch (error) {
                    console.error('Error loading saved data:', error);
                }
            }
            
            showNotification(message, type = 'info') {
                const alertClass = `alert-${type === 'error' ? 'danger' : type}`;
                const notification = document.createElement('div');
                notification.className = `alert ${alertClass} alert-dismissible fade show notification`;
                notification.innerHTML = `
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                `;
                
                document.body.appendChild(notification);
                
                // Auto remove after 3 seconds
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 3000);
            }
        }

        // Initialize the calculator when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            window.gpaCalculator = new GPACalculator();
        });
    </script>
</body>
</html>
